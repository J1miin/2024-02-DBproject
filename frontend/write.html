<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My Spring App</title>
    <link rel="stylesheet" href="write.css" />
  </head>
  <body>
    <div class="flex">
      <div class="contents">
        <header>
          <div class="back-btn">
            <a href="main_writer.html"><img src="images/back.png" /></a>
          </div>
        </header>
        <main>
          <div class="name-container">
            <textarea class="name-area" placeholder="이름"></textarea>
          </div>
          <div class="letter-container">
            <textarea
              class="text-area"
              name="message"
              placeholder="여기에 편지를 작성하세요..."
              maxlength="75"
              oninput="updateCharacterCount(this)"
              required
            ></textarea>
            <p id="char-count">0/75</p>
            <input
              type="button"
              class="submit-button"
              value="굽기"
              onclick="bakeFish()"
            />
          </div>
        </main>
        <footer>
          <div></div>
        </footer>
      </div>
    </div>
  </body>
</html>

<script>
  function updateCharacterCount(textarea) {
    const maxLength = textarea.maxLength;
    const currentLength = textarea.value.length;
    const charCount = document.getElementById("char-count");
    charCount.textContent = `${currentLength}/${maxLength}`;
  }

  function bakeFish() {
    // 현재 시간 저장
    const now = new Date().getTime();

    // 로컬 스토리지에서 기존 상태 가져오기
    const fishStates = JSON.parse(localStorage.getItem("fishStates") || "[]");

    // 새로운 안 익은 붕어빵 추가
    fishStates.push({ state: "nonbaked", addedTime: now });

    // 로컬 스토리지 업데이트
    localStorage.setItem("fishStates", JSON.stringify(fishStates));

    // 메인 페이지로 이동
    alert("붕어빵이 추가되었습니다!");
    window.location.href = "main_writer.html";
  }
</script>
